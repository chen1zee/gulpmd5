define("page/seckill/index",function(s){function a(s){0==s&&setTimeout(function(){window.location.reload()},1e3)}function t(){baseJS.App.initPage("限时秒杀",0,"",1,"",1,getCartItemCount(),"gotoCart")}s("common"),s("countdown");var i=s("gotop");$(function(){e(),i.init()});var e=function(){baseJS.App.initPage("限时秒杀",0,"",1,"",1,getCartItemCount(),"gotoCart"),d(),o()},n=null,l=function(){var s=!1;$(".seckill_list").children(".cart_list_title").each(function(t,i){var e=$(i),l="",o=36e5,c=e.data("stime"),d=e.data("etime"),r=toTwo(new Date(c).getHours()),p=toTwo(new Date(c).getMinutes());if(n>=c){l='<span>抢购中&nbsp; <i class="seckill_stime" style="font-size: .9em "><a href="javascript:void(0)">'+r+":"+p+'</a>开抢</i></span><span class="fr sec_action">距结束&nbsp; <span class="countdown">-- : -- : --</span></span>',e.html(l),e.find(".countdown").attr("id",e.data("id"));var u=e.find(".countdown").attr("id");window.daojishiNum(u,a,d,n)}else{s||(e.before('<div class="seckill_type"><span class="middle_line"></span><span class="seckill_type_text">秒杀预告</span><span class="middle_line"></span></div>'),s=!0),e.siblings(".sec_goodsList").find("button").hide();var g=new Date(c).getDate(),f=new Date(n),m=f.getFullYear()+"/"+(f.getMonth()+1)+"/"+f.getDate(),v=new Date(m+" 23:59:59").getTime();if(v>=c)l='<span><i class="seckill_stime" style="font-size: .9em "><a href="javascript:void(0)">'+r+":"+p+'</a>开抢</i></span><span class="fr sec_action">距开始&nbsp; <span class="countdown">-- : -- : --</span></span>';else if(v+24*o>=c)l='<span><i class="seckill_stime" style="font-size: .9em ">明日 <a href="javascript:void(0)">'+r+":"+p+'</a>开抢</i></span><span class="fr sec_action">距开始&nbsp; <span class="countdown">-- : -- : --</span></span>';else{var _=new Date(c).getMonth()+1;l='<span><i class="seckill_stime" style="font-size: .9em "><a href="javascript:void(0)">'+_+"月"+g+"日 "+r+":"+p+'</a>开抢</i></span><span class="fr sec_action">距开始&nbsp; <span class="countdown">-- : -- : --</span></span>'}e.html(l),e.find(".countdown").attr("id",e.data("id"));var u=e.find(".countdown").attr("id");window.daojishiNum(u,a,c,n)}})},o=function(){baseJS.util.doRequest("",server+"/seckill/seckillGoodsList.cf",{},function(s){if(""!==s.data){$("#tipValue").html(s.data.tipValue),n=null!=s.data.nowTime?parseInt(s.data.nowTime):(new Date).getTime();for(var a="",t=0;t<s.data.seckillMessageList.length;t++){var i=s.data.seckillMessageList[t];if(i.seckillConfigDetailList.length>0){var e=!1,o='<div class="cart_list row_list seckill_list"><div class="cart_list_title" data-stime="'+i.startTime+'" data-etime ='+i.endTime+" data-id="+i.seckillCategoryId+'></div><ul class="sec_goodsList">';$.each(i.seckillConfigDetailList,function(s,a){if(!(a.quantity<=0)){e=!0;var t=a.quantityLeft>0?'<button class="red_button">去抢购</button>':'<button class="grey_button">已售罄</button>',i='<li class="seckill_item"><a href="/app/goods/seckill.html?type=0&sid={0}" target="_blank" title="想买个商品都不行"><img src="{1}" alt=""><div class="row_list_right"><div class="sh_car_product_name">{2}</div><div class="clear"></div><div class="price_area">'+t+'<p class="sec_limitNum">限量{3}件</p><p><span class="discount_price">￥{4}</span><span class="market_price">￥{5}</span></p></div></div></a></li>',n=null!=a.goodsMessagesDTO&&null!=a.goodsMessagesDTO.imagesUrlList&&a.goodsMessagesDTO.imagesUrlList.length>0?a.goodsMessagesDTO.imagesUrlList[0]:defaultProImg;o+=baseJS.util.formatString(i,a.id,n,a.goodsMessagesDTO.name,a.quantity,toMoney(a.price),toMoney(a.goodsMessagesDTO.originalPrice))}}),o+="</ul></div>",e&&(a+=o)}}$("#seckill_list").append(a),l(),c()}})},c=function(){$("div.sh_seconds_kill_tips").show()},d=function(){$("div.sh_cooperative_brand").hide(),baseJS.util.doRequest("",server+"/brand/loadBrandLogo.cf",{},function(s){if(""!==s.data){var a="";$.each(s.data,function(s,t){var i='<li><a href="javascript:void(0)"><img src="{0}"  alt="" width="94" height="55"/></a></li>';a+=baseJS.util.formatString(i,t.logoUrl)}),""!=a&&($("ul.shcb_ul").html(a),$("div.sh_cooperative_brand").show())}})};window.orderOverCallback=function(){window.location.href="/app/user/order.html"},window.closeAutoCallback=function(){t()}});